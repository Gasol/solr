From: Jan-Pascal van Best <janpascal@vanbest.org>
Subject: [PATCH] debian/use-debian-java-libraries

Link to libraries under /usr/share/java instead of those
included with upstream tarball. Do not include the libraries
into the war file.

Signed-off-by: Thomas Koch <thomas.koch@ymc.ch>

---
 build.xml |   40 ++++++++++++++++++++++++++++------------
 1 files changed, 28 insertions(+), 12 deletions(-)

diff --git a/build.xml b/build.xml
index 77dc9e3..03280eb 100644
--- a/build.xml
+++ b/build.xml
@@ -22,7 +22,7 @@
   <import file="common-build.xml"/>
   
   <!-- 3rd party libraries for compilation -->
-  <property name="lib" value="lib" />
+  <property name="lib" value="/usr/share/java" />
 
   <!-- solr source files -->
   <property name="src" value="src" />
@@ -111,7 +111,23 @@
   <!-- The compilation classpath -->
   <path id="compile.classpath">
     <fileset dir="${lib}">
-      <include name="*.jar" />
+      <include name="servlet-api-2.5.jar" />
+      <include name="lucene-core.jar" />
+      <include name="lucene-analyzers.jar" />
+      <include name="lucene-highlighter.jar" />
+      <include name="lucene-queries.jar" />
+      <include name="lucene-snowball.jar" />
+      <include name="lucene-spellchecker.jar" />
+      <include name="commons-codec.jar" />
+      <include name="commons-csv.jar" />
+      <include name="commons-fileupload.jar" />
+      <include name="commons-httpclient.jar" />
+      <include name="commons-io.jar" />
+      <include name="commons-logging.jar" />
+      <include name="xpp3.jar" />
+      <include name="easymock.jar" />
+      <include name="jetty.jar" />
+      <include name="jetty-util.jar" />
     </fileset>
     <pathelement location="${dest}/common"/>
   </path>
@@ -304,9 +320,8 @@
       <include name="*.jar" />
     </fileset>
     <fileset dir="${lib}">
-      <include name="commons-io-*.jar" />
-      <include name="*stax-*.jar" />
-      <include name="wstx-*.jar" />
+      <include name="commons-io.jar" />
+      <include name="commons-httpclient.jar" />
     </fileset>
     <pathelement location="${dest}/common"/>
   </path>
@@ -318,8 +333,14 @@
     <pathelement location="${dest}/core"/>
     
     <!-- jetty -->
-    <fileset dir="example/lib">
-      <include name="**/*.jar" />
+    <fileset dir="/usr/share/java">
+      <include name="jetty.jar" />
+      <include name="jetty-util.jar" />
+      <include name="jsp-api-2.1.jar" />
+      <include name="el-api-2.1.jar" />
+      <include name="jasper.jar" />
+      <include name="jasper-el.jar" />
+      <include name="tomcat-juli.jar" />
     </fileset>
   </path>
     
@@ -520,10 +541,6 @@
          webxml="${src}/webapp/web/WEB-INF/web.xml"
          filesetmanifest="skip"
          manifest="${dest}/META-INF/MANIFEST.MF">
-       <lib dir="${lib}">
-         <exclude name="servlet-api*.jar" />
-         <exclude name="easymock.jar" />
-       </lib>
        <lib dir="${dist}">
          <include name="${fullname}-core-${version}.jar" />
          <include name="${fullname}-common-${version}.jar" />
@@ -598,7 +615,6 @@
       <fileset dir="${lib}">
         <include name="commons-codec-*.jar"/>
         <include name="commons-io-*.jar"/>
-        <include name="*stax-*.jar" />
         <include name="wstx-*.jar" />
       </fileset>
       <fileset dir="${solrj-dir}/lib">
-- 
tg: (a1b411f..) debian/use-debian-java-libraries (depends on: upstream)
